# URL Shortener (консольный сервис)

Консольный сервис сокращения ссылок с лимитом переходов и временем жизни. Данные хранятся в JSON файлах, без базы данных.

## Возможности
- создание короткой ссылки из длинного URL
- уникальные короткие ссылки для разных пользователей
- лимит переходов по каждой ссылке
- срок жизни ссылки (TTL) из конфигурации
- уведомления в консоли о недоступности ссылки

## Требования
- Java 21

## Конфигурация
Файл: `url-shortener-cli/src/main/resources/application.properties`

Доступные параметры:
- `shorty.links.path` — путь к файлу со ссылками (по умолчанию `data/links.json`)
- `shorty.user.path` — путь к файлу пользователя (по умолчанию `data/user.json`)
- `shorty.defaultMaxClicks` — лимит переходов по умолчанию (по умолчанию `3`)
- `shorty.linkTtlHours` — срок жизни ссылки в часах (по умолчанию `24`)

## Запуск

### В IntelliJ IDEA
1. Run → Edit Configurations…
2. Add → Application
3. Main class: `dev.shorty.cli.Main`
4. Use classpath of module: `url-shortener-cli`
5. Working directory: `c:\Users\admin\IdeaProjects\url-shortener`
6. Run

### Через Gradle
```
.\gradlew.bat :url-shortener-cli:run --console=plain
```

## Использование

### Интерактивное меню
Запуск без аргументов открывает меню:
1) Инициализировать пользователя  
2) Создать короткую ссылку  
3) Открыть короткую ссылку  
4) Мои ссылки  
5) Информация о ссылке  
6) Изменить лимит переходов  
7) Удалить ссылку  
8) Очистить истекшие  
0) Выход

### Команды
Примеры запуска с аргументами:
```
shorty init
shorty create --url https://example.com
shorty open Ab12Cd34
shorty list
shorty info Ab12Cd34
shorty edit Ab12Cd34 --max-clicks 5
shorty delete Ab12Cd34
shorty cleanup
```

## Как определяется пользователь
- При первом создании ссылки или при `init` генерируется UUID.
- UUID сохраняется в файл `data/user.json`.
- Все операции со ссылками доступны только текущему пользователю (по UUID).
- Чтобы создать нового пользователя, удалите `data/user.json` и запустите `init` заново.

## Хранение данных
- Ссылки: `data/links.json`
- Пользователь: `data/user.json`

## Проверка лимита и TTL
- При переходе по ссылке счетчик увеличивается.
- При достижении лимита переходов ссылка блокируется, выводится уведомление.
- По истечении TTL ссылка считается недействительной и удаляется при попытке открытия или через `cleanup`.
